ShowMorality();
    math.randomseed(os.time());
    local n = getitemcountinbag(182);
if (n>=1) then
    local k=math.modf(n-1);
    newtalk("你已勝"..k.."場。",300,0);
    array={276,16,235,277,226,233,234,249,278,39,40,41,48,222,237,245,253,254,203,61,62,64,65,2,8,69,220,229,230,231,232,236,18,52,157,158,159,178,180,181,182,209,250,292,99,242,3,30,36,53,85,151,238,251,267,268,293,246,0,78,212,215,228,259,260,274,275,280,294,336,63,239,1,32,201,204,219,37,82,102,136,144,156,160,190,225,252,89,243,261,295,66,227,10,20,21,75,84,92,96,135,137,149,150,161,247,255,256,257,258,264,269,279,285,309,9,11,12,266,192,334,296,221,270,24,49,60,67,104,132,146,173,174,193,197,198,213,216,272,273,339,7,72,297,262,194,14,19,147,148,4,15,25,27,33,42,55,68,70,88,91,105,106,139,142,145,152,155,175,189,191,195,210,224,300,322,119,120,121,90,122,73,94,95,123,140,143,153,199,241,124,125,17,126,127,13,22,23,26,29,87,97,103,108,128,154,176,187,196,214,217,223,281,282,301,307,320,335,129,107,130,131,110,138,200,109,206,326,74,98,112,141,166,183,205,283,291,311,312,265,284,5,50,133,134,184,186,298,299,263,28,51,71,86,100,111,113,114,115,117,118,185,207,208,286,287,288,289,302,313,38,93,116,165,202,290,43,179,319,323,324,354,271,6,31,58,59,76,79,80,83,162,163,167,188,248,303,314,315,316,317,318,325,327,337,77,171,304,305,306,310,44,35,172,81,45,330,328,34,56,57,168,240,321,329,331,338,340,341,342,346,347,348,349,350,351,352,46,344,332,333,343,345,353,47,54,101,164,169,170,177,211,218,244,308}
    local k = n + math.random(0, 2);
    if k < 1 then
        k = 1;
    end
    if k>#array then
        k = #array - 10 + math.random(0, 10);
    end
    if (trybattle(array[k], 0)) then
        local m = math.random(0,236)
        additem(m,1)
        additem(174, k);
        additemwithouthint(182, 1);
        additemwithouthint(209, math.random(0, 5));
        additemwithouthint(210, math.random(0, 5));
    else
        --additemwithouthint(199, 1);
    end
    autosave()
end